Make Your Home Safe: Time-aware Unsupervised User Behavior
Anomaly Detection in Smart Homes via Loss-guided Mask
JingyuXiao‚àó ZhiyaoXu‚àó QingsongZou‚àó
PengChengLaboratory Xi‚ÄôanUniversityofElectronicScience TsinghuaShenzhenInternational
TsinghuaShenzhenInternational andTechnology GraduateSchool
GraduateSchool Xi‚Äôan,China PengChengLaboratory
Shenzhen,China 21009200843@stu.xidian.edu.cn Shenzhen,China
jy-xiao21@mails.tsinghua.edu.cn zouqs21@mails.tsinghua.edu.cn
QingLi‚Ä† DanZhao DongFang
PengChengLaboratory PengChengLaboratory Tencent
Shenzhen,China Shenzhen,China Shenzhen,China
liq@pcl.ac.cn zhaod01@pcl.ac.cn victordfang@tencent.com
RuoyuLi WenxinTang KangLi
TsinghuaShenzhenInternational TsinghuaShenzhenInternational TsinghuaShenzhenInternational
GraduateSchool GraduateSchool GraduateSchool
Shenzhen,China Shenzhen,China Shenzhen,China
liry19@mails.tsinghua.edu.cn vinsontang2126@gmail.com lk26603878@gmail.com
XudongZuo PenghuiHu YongJiang
TsinghuaShenzhenInternational TsinghuaUniversity TsinghuaShenzhenInternational
GraduateSchool Beijing,China GraduateSchool
Shenzhen,China huph22@mails.tsinghua.edu.cn PengChengLaboratory
zuoxd20@mails.tsinghua.edu.cn Shenzhen,China
jiangy@sz.tsinghua.edu.cn
ZixuanWeng MichaelR.Lyu
BeijingJiaotongUniversity TheChineseUniversityofHongKong
Beijing,China HongKong,China
20722027@bjtu.edu.cn lyu@cse.cuhk.edu.hk
ABSTRACT aLoss-guidedDynamicMaskStrategy(LDMS)toencouragethe
Smarthomes,poweredbytheInternetofThings,offergreatconve- modeltolearnlessfrequentbehaviors,whichareoftenoverlooked
niencebutalsoposesecurityconcernsduetoabnormalbehaviors, duringlearning.Second,weproposeaThree-levelTime-awarePo-
suchasimproperoperationsofusersandpotentialattacksfrom sitionEmbedding(TTPE)toincorporatetemporalinformationinto
maliciousattackers.Severalbehaviormodelingmethodshavebeen positionalembeddingtodetecttemporalcontextanomaly.Third,
proposedtoidentifyabnormalbehaviorsandmitigatepotential weproposeaNoise-awareWeightedReconstructionLoss(NWRL)
risks.However,theirperformanceoftenfallsshortbecausethey thatassignsdifferentweightsforroutinebehaviorsandnoisebehav-
donoteffectivelylearnlessfrequentbehaviors,considertemporal iorstomitigatetheinterferenceofnoisebehaviorsduringinference.
context,oraccountfortheimpactofnoiseinhumanbehaviors.In ComprehensiveexperimentsdemonstratethatSmartGuardconsis-
thispaper,weproposeSmartGuard,anautoencoder-basedunsuper- tentlyoutperformsstate-of-the-artbaselinesandalsooffershighly
viseduserbehavioranomalydetectionframework.First,wedesign interpretableresults.
‚àóThefirstthreeauthorshaveequalcontribution.
CCSCONCEPTS
‚Ä†QingLiisthecorrespondingauthor.
‚Ä¢Securityandprivacy‚ÜíHumanandsocietalaspectsofse-
ThisworkislicensedunderaCreativeCommonsAttribution curityandprivacy.
International4.0License.
KEYWORDS
KDD‚Äô24,August25‚Äì29,2024,Barcelona,Spain
¬©2024Copyrightheldbytheowner/author(s).PublicationrightslicensedtoACM.
UserBehaviorModeling,AnomalyDetection,Transformer,Smart
ACMISBN979-8-4007-0490-1/24/08
https://doi.org/10.1145/3637528.3671708 Homes
4202
nuJ
81
]RC.sc[
2v82901.6042:viXra
KDD‚Äô24,August25‚Äì29,2024,Barcelona,Spain JingyuXiao,ZhiyaoXuandQingsongZouetal.
ACMReferenceFormat:
JingyuXiao,ZhiyaoXu,QingsongZou,QingLi,DanZhao,DongFang,
RuoyuLi,WenxinTang,KangLi,XudongZuo,PenghuiHu,YongJiang,
ZixuanWeng,andMichaelR.Lyu.2024.MakeYourHomeSafe:Time-aware
UnsupervisedUserBehaviorAnomalyDetectioninSmartHomesviaLoss-
guidedMask.InProceedingsofthe30thACMSIGKDDConferenceonKnowl-
edgeDiscoveryandDataMining(KDD‚Äô24),August25‚Äì29,2024,Barcelona,
Spain.ACM,NewYork,NY,USA,12pages.https://doi.org/10.1145/3637528.
3671708
1 INTRODUCTION
TherapidgrowthofIoTsolutionshasledtoanunprecedented
increaseinsmartdeviceswithinhomes,expectedtoreachapprox-
imately5billionby2025[24].However,theabnormalbehaviors
posesubstantialsecurityriskswithinsmarthomes.Theseabnor-
malbehaviorsusuallyoriginatefromtwoprimarysources.First,
improperoperationsbyuserscancauseabnormalbehaviors,such
asinadvertentlyactivatingtheairconditioner‚Äôscoolingmodedur-
ingwinterorforgettingtocloseawatervalve.Second,malicious
attackerscanexploitvulnerabilitieswithinIoTdevicesandplat-
forms,takingunauthorizedcontrolofthesedevices.Forexample,
hackerscancompromiseIoTplatforms,allowingthemtodisable
securitycamerasandmanipulatehomeautomationsystems,creat-
ingopportunitiesforburglary.Thesesecurityconcernsemphasize
theurgencyofrobustbehavioralmodelingmethodsandenhanced
securitymeasurestosafeguardsmarthomeenvironments.
Deeplearninghasbeenemployedacrossvariousdomainsto
mine correlations between behaviors for modeling user behav-
iorsequences[22,31,32]andaddresssecurityissues[2,13‚Äì15].
DeepMove[9]leveragesRNNstomodelbothlongandshort-term
mobilitypatternsofusersforhumanmobilityprediction.Tocap-
ture the dynamics of user‚Äôs behaviors, SASRec [20] proposes a
self-attentionbasedmodeltoachievesequentialrecommendation.
Morerecentefforts[4,8,30]primarilyfocusontransformer-based
modelsfortheirsuperiorabilitytohandlesequentialbehaviordata.
However,wecannotborrowtheabovemodelstodirectlyapply
theminourscenarios,becauseofthefollowingthreechallengesof
userbehaviormodelinginsmarthomes.
600
400
200
0
0 10 20 30 40 50 60 70
Behavior ID
roivaheB
fo
rebmuN
0.020
0.015
0.010
0.005
0.000
ssoL
noitcurtsnoceR
(e.g.,usingmicrowaveandoven)ofofficeworkersmaybeinfre-
quent,becausetheydineattheirworkplaceonweekdaysandonly
cookonweekends.Ontheotherhand,somedailybehaviorslike
turningonlightsandwatchingTVofthesameuserscanbemore
frequent.Behaviorimbalancecomplicatesthelearningprocessfor
models:somebehaviors,whichoccurfrequentlyinsimilarcontexts,
canbeeasilyinferred,whileothersthatrarelyappearormanifest
indiversecontextscanbemorechallengingtoinfer.Wetrainan
autoencodermodelonANdataset(showninTable1),recordtheoc-
currencesandreconstructionlossofdifferentbehaviors.Asshown
inFigure1,withthenumberofoccurrencesofbehaviordecreases,
thereconstructionlosstendstoincrease.
Second,temporalcontext,e.g.,thetiminganddurationofuser
behaviors,playsasignificantroleinabnormalbehaviordetection
butisoverlookedbyexistingsolutions.Forexample,turningon
thecoolingmodeoftheairconditionerinwinterisabnormal,but
isnormalinsummer.Showeringfor30-40minutesisnormal,but
exceeding2hoursuggestsauseraccident.Ignoringtiminginforma-
tionhinderstheidentificationofabnormalbehaviorpatterns.As
showninFigure2,sequence1representsauser‚Äôsnormallaundry-
related behaviors. Sequences 2 and 3 follow the same order as
sequence1.However,insequence2,thewatervalvewereopensat
2o‚Äôclockinthenight.Insequence3,thedurationbetweenopening
2 Problem Definition
andclosingthewatervalveisexcessivelylong.Thereforethese
twosequencesshouldbeidentifiedasabnormalbehaviorspossibly
conductedbyattackersintendingtoinducewaterleakage.
open open notification close
9am 9:10am 9:50am 10am
open open notification close
2am 2:10am 2:50am 3am
open open notification close
9am 9:10am 9:50am ‚Ä¶‚Ä¶ 12am
Figure 2: Example of three user behaviors with the same
behaviororder.Sequence2and3areabnormalduetotheir
inappropriatetimingandexcessiveduration.
Third,arbitraryintentsandpassivedeviceactionscancause
noisebehaviorsinuserbehaviorsequences,whichinterferemodel‚Äôs
inference.Figure3showsnoisebehaviorsinabehaviorsequence
relatedtoauser‚Äôsbehaviorsaftergettingup.Theuserdosome
Figure1:Reconstructionlossesforbehaviorswithdifferent
routinebehaviorslike‚Äúturnonthebedlight‚Äù,‚Äúopenthecurtains‚Äù,
occurrencefrequencies.
‚Äúswitchofftheairconditioner‚Äù,‚Äúopentherefrigerator‚Äù,‚Äúclosethe
refrigerator‚Äùand‚Äúswitchontheoven‚Äù.However,therearealso
First,theoccurrencefrequenciesofdifferentuserbehaviorsmay somesporadicactionswhicharenottightlyrelatedtothebehavior
beimbalanced,leadingtochallengesinlearningthesemanticsof sequence,including1)activebehaviors,e.g.,suddenlydecidingto
thesebehaviors.Thisuserbehaviorimbalancecanbeattributed ‚Äúturnonthenetworkaudio‚Äùtolistentomusic;2)passivebehavior
toindividuals‚Äôlivinghabits.Forexample,cook-relatedbehaviors fromdevices,e.g.,the‚Äúself-refresh‚Äùoftheairpurifier.Thesenoise
MakeYourHomeSafe:Time-awareUnsupervisedUserBehaviorAnomalyDetectioninSmartHomesviaLoss-guidedMask KDD‚Äô24,August25‚Äì29,2024,Barcelona,Spain
behaviorsmayalsooccurinothersequenceswithvaryingpatterns. andmulti-levelperiodicities.However,abovemethodsaimatpre-
Thesenoisebehaviorsintroducesuncertaintythatcandisruptthe dictingnextbehaviorofuseraccurately,theycannotbeapplied
learningprocessandleadthemodeltomisclassifysequencescon- intoabnormalbehaviordetection.
taining noise behaviors as anomalies. Therefore, treating noise
behaviorsonparwithnormalbehaviorscouldpotentiallyharmthe 2.2 AttacksandDefensesinSmartHomes
model‚Äôsperformance,leadingtoincreasedlosses. Anincreasingnumberofattackvectorshavebeenidentifiedin
smarthomesinrecentyears.Inadditiontocyberattacks,itisalsoa
on open off open close open switch onself-refresh concerningfactorthatIoTdevicesareoftencloseassociationwith
theuser‚Äôsphysicalenvironmentandtheyhavetheabilitytoalter
ùë°( ùë°‚Äô ùë°" ùë°! ùë°# ùë°$ ùë°% ùë°& physicalenvironment.Inthiscontext,theautomationintroduces
moreserioussecurityrisks.Priorresearchhasrevealedthatad-
routine behaviors noise behaviors
versariescanleakpersonalinformation,andgainphysicalaccess
tothehome[3,19].In[10],spoofattackisemployedtoexploit
l b ig e h d t curtain cond a it ir io ner refrigerator oven ne au tw d o io rk pu a ri i f r i er automationrulesandtriggerunexpecteddeviceactions.[7,11]
applydelay-basedattackstodisruptcross-platformIoTinforma-
tionexchanges,resultinginunexpectedinteractions,renderingIoT
Figure3:Anexampleofnoisebehaviors.
devicesandsmarthomesinaninsecurestate.Thisseriesofattacks
aim at causing smart home devices to exhibit expected actions,
Inthispaper,weproposeSmartGuardtosolveabovechallenges.
therebyposingsignificantsecuritythreats.Therefore,designingan
SmartGuardisanautoencoder-basedarchitecture,whichlearnsto
effectivemechanismtodetectsuchattacksisnecessary.6thSense
reconstructnormalbehaviorsequencesduringtrainingandidentify
[27]utilizesNaiveBayestodetectmaliciousbehaviorassociated
thebehaviorsequenceswithhighreconstructionlossasanomaly.
withsensorsinsmarthomes.Aegis[28]utilizesaMarkovChainto
Firstly,wedeviseaLoss-guidedDynamicMaskStrategy(LDMS)
detectmaliciousbehaviors.ARGUS[26]designedanAutoencoder
topromotethemodel‚Äôslearningofinfrequenthard-to-learnbehav-
basedonGatedRecurrentUnits(GRU)todetectinfiltrationattacks.
iors.Secondly,weintroduceaThree-levelTime-awarePosition
However,thesemethodsignorethebehaviorimbalance,temporal
Embedding(TTPE)tointegratetemporalinformationintoposi-
informationandnoisebehaviors.
tionalembeddingfordetectingtemporalcontextanomalies.Lastly,
weproposeaNoise-awareWeightedReconstructionLoss(NWRL)
3 PROBLEMFORMULATION
toassigndistinctweightstoroutinebehaviorsandnoisebehaviors,
LetDdenoteasetofdevices,Cdenoteasetofdevicecontrolsand
therebymitigatingtheimpactofnoisebehaviors.Ourcodesare
releasedtotheGitHub1.Ourcontributionscanbesummarizedas Sdenoteasetofbehaviorsequences.
follows: Definition1. (Behavior)Abehaviorùëè = (ùë°,ùëë,ùëê),isa3-tuple
‚Ä¢ WedesignLDMStomaskthebehaviorswithhighrecon- consistingoftimestampùë°,deviceùëë ‚ààDanddevicecontrolùëê ‚ààC.
structionloss,thusencouragingthemodeltolearnthese
Forexample,behaviorb=(2022-08-0418:30,airconditioner,air
hard-to-learnbehaviors.
conditioner:switchon)describesthebehavior‚Äúswichontheaircon-
‚Ä¢ WeproposeTTPEtoconsidertheorder-level,moment-level
ditioner‚Äùat18:30on2022-08-04.
andduration-levelinformationofuserbehaviorsmeanwhile.
‚Ä¢ WedesignNWRLtotreatnoisybehaviorsandnormalbehav- Definition2. (BehaviorSequence)Abehaviorsequenceùë† =
iorsdifferentlyforlearningrobustbehaviorrepresentations. [ùëè
1
,ùëè
2
,¬∑¬∑¬∑,ùëè ùëõ] ‚ààSisalistofbehaviors,orderedbytheirtimestamps,
andùëõisthelengthofùë†.
2 RELATEDWORK
WedefinetheUserBehaviorSequence(UBS)anomalydetection
2.1 UserBehaviorModelinginSmartHomes
problemasfollows.
Someworksproposetomodeluserbehavior(i.e.,userdevicein-
Problem 1. (UBS Anomaly Detection) Given a behavior se-
teraction)basedondeeplearning.[16]useseventtransitiongraph
quenceùë†,determinewhetherùë†isananomalyeventoranormalevent.
tomodelIoTcontextanddetectanomalies.In[34],authorsbuild
deviceinteractiongraphtolearnthedevicestatetransitionrela- Inthispaper,weconsiderfourtypesofabnormalbehaviors:
tionshipcausedbyuseractions.[12]detectsanomaliesthroughcor-
‚Ä¢ (SD)SingleDevicecontextanomaly(Figure4(a)),definedas
relationalanalysisofdeviceactionsandphysicalenvironment.[29]
unusualhighfrequencyoperationsonasingledevice,e.g.,
infersuserbehaviorthroughreadingsfromvarioussensorsinstalled
frequentlyswitchinglightonandofftobreakthelight.
intheuser‚Äôshome.IoTBeholder[38]utilizesattention-basedLSTM
‚Ä¢ (MD)MultipleDevicescontextanomaly(Figure4(b)),de-
topredicttheuserbehaviorfromhistorysequences.SmartSense
finedasthesimultaneousoccurrenceofbehaviorsonmul-
[18]leveragesquery-basedtransformertomodelcontextualinfor-
tiple devices that are not supposed to occur in the same
mationofuserbehaviorsequences.DeepUDI[35]andSmartUDI
sequence,e.g.,turningoffthecameraandopeningthewin-
[36]userelationalgatedgraphneuralnetworks,capsuleneural
dowforburglary.
networksandcontrastivelearningtomodelusers‚Äôroutines,intents
‚Ä¢ (DM)Devicecontrol-Momentcontextanomaly(Figure4(c)),
1https://github.com/xjywhu/SmartGuard definedasadevicecontroloccurringataninappropriate
Challenge
1
KDD‚Äô24,August25‚Äì29,2024,Barcelona,Spain JingyuXiao,ZhiyaoXuandQingsongZouetal.
2)randommask:maskingbehaviorsateveryepochrandomlyto
reconstruct the masked behaviors; 3) top-ùëò loss mask: masking
topùëòb(ea)h Aatvteinotriosn wWietighhhtigherreconstructionlosstoreconstructthe
on off broken close open theft masked behaviors. We set mask ratio as 20% for the latter two.
(a) Single Device Context Anomaly. (b) Multiple Devices Context Anomaly. Figure6showsthechangingtrendsofthereconstructionlossand
it‚ÄôsvarianceofdifferentbehaviorduringtrainingonSPdataset
(describedinTable1).First,asshowninFigure6(a),themodel
withoutmaskshowsthefastestconvergencetrend,whereasthe
cooling winter cold open three hours flood lossofthemodelwithmaskfluctuates.Modelwithoutmaskcan
(c) Device Control-Moment Context Anomaly. (d) Device Control-Duration Context Anomaly. simultaneouslylearnallbehaviors,facilitatingrapidconvergence.
Incontrast,themaskstrategyonlyencouragesthemodeltofocus
Figure4:Differenttypesofanomalybehaviors. onlearningmaskedbehaviors,whichmayhinderinitial-stagecon-
vergence.Second,themodelwithtop-ùëòlossmaskstrategyshows
lowestvariancetowardstheendoftrainingasshowninFigure6(b),
time,e.g.,turningonthecoolingmodeofanairconditioner becausethetop-ùëò lossmaskstrategyeffectivelyencouragesthe
inwinter,potentiallycausingtheusertocatchacold. modeltolearnhard-to-learnbehaviors(i.e.,thebehaviorswithhigh
‚Ä¢ (DD)Devicecontrol-Durationcontextanomaly(Figure4(d)), reconstruction loss), thereby reducing the variance of behavior
definedasdevicecontrolsthatlastforaninappropriatedu- reconstructionlosses.
ration,e.g.,leavingawatervalveopenfor3hoursforflood Inthispaper,wedesignaLoss-guidedDynamicMaskStrategy.
attack. Intuitively,atthebeginningoftraining,weencouragethemodel
tolearntherelativelyeasytasktoaccelerateconvergence,i.e.,
4 METHODOLOGY behaviorsequencereconstructionwithoutmask.AftertrainingùëÅ
epochswithoutmask,weadoptthetop-ùëò lossmaskstrategyto
4.1 SolutionOverview
encouragethemodeltolearnthemaskedbehaviorswith
Toachieveaccurateuserbehaviorsequenceanomalydetectionin
high reconstruction loss. We continuously track the model‚Äôs
smarthomes,weproposeSmartGuard,depictedinFigure5.The
reconstructionlossofdifferentbehaviorsbyupdatingalossvector
workflowofSmartGuardcanbesummarizedasfollows.During
ineachepochtoguidethemaskstrategyinthenextepoch.In
training,theLoss-guidedDynamicMaskStrategy(¬ß4.2)isinitially epochùëíùëù,thelossvectorL ùëíùëù iscalculatedas:
vec
employedtomaskhard-to-learnbehaviorsbasedonthelossvec-
torL vecfromthepreviousepoch.Subsequently,theThree-level L v ùëí e ùëù c = (cid:8)‚Ñì 1 ,‚Ñì 2 ,...,‚Ñì ùëê ,...,‚Ñì |C| (cid:9),ùëê ‚ààC, (1)
T
le
i
v
m
e
e
l,
-a
m
w
o
a
m
re
en
P
t
o
-
s
l
i
e
t
v
io
e
n
l,
a
a
l
n
E
d
nc
d
o
u
d
r
e
a
r
ti
(
o
¬ß
n
4
-
.3
le
.1
v
)
e
i
l
s
t
a
e
p
m
p
p
li
o
e
r
d
a
t
l
o
in
c
f
a
o
p
r
t
m
ur
a
e
ti
o
o
r
n
de
o
r
f
-
‚Ñì ùëê = ùëõ 1 ‚àëÔ∏Å
ùëõùëê
‚Ñì ùëê ùëñ, (2)
thebehaviors,producingthepositionalembeddingùëÉùê∏.Thisembed- ùëê ùëñ=1
dingisthenaddedtothedevicecontrolembedding‚Ñé ùëê toformthe whereùëõ ùëêisthenumberoftimesthedevicecontrolùëêoccursinepoch
behaviorembeddingh.Finally,hisfedintoanùêø-layerattention- ùëíùëù,and‚Ñì ùëê istheaveragereconstructionlossofthedevicecontrol
basedencoderanddecodertoextractcontextualinformationfor
ùëê.Inepochùëíùëù+1,themaskvectorforbehaviorsequencesample
reconstructingthesourcesequence.Duringtheinferencephase,the ùë† = [ùëè 1 ,ùëè 2 ,¬∑¬∑¬∑,ùëè ùëõ]isobtainedas:
N Re o c is o e n - s a t w ru a c r t e io W n e L ig o h ss te ( d ¬ß4 R .4 e ) co is n u st t r i u li c z t e i d on to L a o s s s s ig N n o d is i e ff - e a r w en ar t e w W ei e g i h gh ts te to d ùëöùëéùë†ùëò(ùëñ)= (cid:110) 1 0 , , i i f f ùëñ ùëñ ‚àâ ‚àà ùë† ùë† ùëú ùëú ùëü ùëü ùë° ùë° ùëí ùëí ùëë ùëë _ _ ùëñ ùëñ ùëõ ùëõ ùëë ùëë ùëí ùëí ùë• ùë• [ [ : : ‚åä ‚åä ùëõ ùëõ ¬∑ ¬∑ ùëü ùëü ‚åã ‚åã ] ] ,ùëñ ‚àà [1,ùëõ], (3)
variousbehaviors,determinedbythelossvectorfromthetraining (cid:16)(cid:110) ùëíùëù ùëíùëù ùëíùëù (cid:111)(cid:17)
dataset,resultinginthefinalreconstructionlossùë†ùëêùëúùëüùëí.Iftheùë†ùëêùëúùëüùëí ùë†ùëúùëüùë°ùëíùëë_ùëñùëõùëëùëíùë• =argsort L vec (ùëè 1 ),L vec (ùëè 2 ),....L vec (ùëè ùëõ) , (4)
surpassesthethresholdùë°‚Ñé,SmartGuardtriggersanalarm. whereargsortgetsthesortedindexwithdescendingorderofthe
elementsinthevector,ùëü ‚àà [0,1] isthemaskratio,andùëõ isthe
4.2 Loss-guidedDynamicMaskStrategy lengthofbehaviorsequenceùë†.
Autoencoders[37],whichtakecompletedatainstancesasinput
4.3 AutoencoderwithTemporalInformation
andtargettoreconstructtheentireinputdata,arewidelyusedin
anomalydetection.Differentfromtraditionalautoencoders,masked 4.3.1 Three-levelTime-awarePositionalEncoder. Thetem-
autoencodersrandomlymaskaportionofinputdata,encodingthe poralinformationinuserbehaviorsequencedataprimarilyresides
partially-maskeddataandaimingtoreconstructthemaskedtokens. inthetimingofcontrolbehaviors,whichcanbeexaminedfrom
Byintroducingamoremeaningfulself-supervisedtask,maskedau- twoperspectives:theabsolutetimingofeachindividualcontrol
toencodershaverecentlyexcelledinimages[17]learning.However, behavior,andtherelativetiminggapbetweencontrolactionson
suchreconstructiontaskswithoutmaskandwithrandommaskare thesamedevice.Ontheonehand,therelativetiminggapbetween
sub-optimalinourscenariosbecausetheydonotemphasizethe controlactionsonthesamedevicereflectsthedurationthedevice
learningofhard-to-learnbehaviorsthatoccurrarely. isinsomespecificstateandtheoperationfrequencyoftheuser.
Weconductexperimentstoverifytheperformanceofautoen- Ontheonehand,userbehaviorsareusuallytime-regulated,and
coders trained with three mask options: 1) w/o mask: no mask thefunctionalitiesadevicecarriedcandeterminetheabsolutetim-
strategyisused,theobjectivefunctionistoreconstructtheinput; ingusersoperateonit.Forexample,usersusuallyoperatelights
MakeYourHomeSafe:Time-awareUnsupervisedUserBehaviorAnomalyDetectioninSmartHomesviaLoss-guidedMask KDD‚Äô24,August25‚Äì29,2024,Barcelona,Spain
0 1 2 3 4 5 6 7 order
Behavior Weight ùëæùíìùíÜùíÑ Noise-aware
‚Ä¶‚Ä¶ Weighted
ùë° ( ùë° ‚Äô ùë° " duration ùë° ! ùë° # dur ùë° a $ tion ùë° % ùë° & moment Reconstruction
Noise Behaviors Loss
Loss-guided Dynamic Masked Strategy Loss Loss Vector ‚ÑíùíóùíÜùíÑ Yes No
<ùíïùíâ?
hard-to-learn
easy-to-learn
Mask Mask Mask
Behavior Encoder & Decoder
Update
Three-level Time-aware Positional Device Control Architecture
Encoder Encoder Reconstruction Loss ‚ÑíùíìùíÜùíÑ
Order Hour Day Duration DeviceControl ‚Ä¶‚Ä¶ Multi-head
Embedding Embedding Embedding Embedding Embedding
ùë∑ùë¨(ùë∂ùíìùíÖùíÜùíì) ùë∑ùë¨(ùëØùíêùíñùíì) ùë∑ùë¨(ùë´ùíÇùíö) ùë∑ùë¨(ùë´ùíñùíìùíÇùíïùíäùíêùíè) ùíâùíÑ Attention
ùêø√ó Add & Norm
Prediction Layer
Feed Forward
Behavior
Embedding h
Add & Norm
Sequence Encoder Sequence Decoder
Figure5:Theoverviewof SmartGuard.
1.2 1.0 0.8 0.6
0.4
0.2 0.0
123456789101112131415 Training Step
ssoL noitcurtsnoceR
fo naeM
w/o Mask 10 Random Mask Top-k Loss Mask 8 6
4
2 0
123456789101112131415 Training Step
(a)Meanofreconstructionloss.
ssoL
noitcurtsnoceR
fo
ecnairaV
Then,thepositionalembeddingiscalculatedas:
1.50 1.25 1.00 0 0 . . 5 7 0 5 ùëÉùê∏=ùë§ ùëúùëüùëëùëíùëü ¬∑ùëÉùê∏(ùëùùëúùë†)+ùë§ ‚Ñéùëúùë¢ùëü ¬∑ùëÉùê∏(‚Ñéùëúùë¢ùëü)+ 0 0 . . 0 2 0 5 9 101112131415 ùë§ ùëëùëéùë¶¬∑ùëÉùê∏(ùëëùëéùë¶)+ùë§
ùëëùë¢ùëü
¬∑ùëÉùê∏(ùëëùë¢ùëüùëéùë°ùëñùëúùëõ), (6)
w/o Mask R To a p n - d k o L m os M s a M s a k sk whereùë§ ùëúùëüùëëùëíùëü,ùë§ ‚Ñéùëúùë¢ùëü,ùë§ ùëëùëéùë¶ andùë§ ùëëùë¢ùëü arelearnableweights.ùëÉùê∏(¬∑)
isapositionalencodingfunction[33]definedas:
(b)Varianceofreconstructionloss.
ùëÉùê∏ (¬∑,2ùëñ) =sin
(cid:16) ¬∑/100002ùëñ/ùëë(cid:17)
,
(7)
F
d
i
i
g
ff
u
e
r
r
e
en
6
t
:A
m
u
a
t
s
o
k
en
st
c
r
o
a
d
te
e
g
r
i
t
e
r
s
a
.
iningprocessonSPdatasetunder
ùëÉùê∏ (¬∑,2ùëñ+1) =cos
(cid:16) ¬∑/100002ùëñ/ùëë(cid:17)
,
whereùëñdenotestheùëñ-thdimensionofthepositionalembedding,ùëë
isthedimensionoftemporalembedding.
inthemorningandevening,andoperatethemicrowaveandthe
ovenatmealtime.Sincecertainoperationsfrequentlytakeplace Tolearntherepresentation‚Ñé ùëê fordevicecontrolùëê ‚ààC,wefirst
encodedevicecontrolùëêintoalow-dimensionallatentspacethrough
nearlysimultaneously,wewillalsoconsidertheorderofbehaviors
devicecontrolencoder,i.e.,anembeddinglayer.Finally,weadd
toprovideamorecomprehensivecharacterizationofbehaviors
positionalembeddingtothedevicecontrolembeddingasfollowing
thatoccursuccessively.Therefore,weincorporatethreetypesof
togetthebehaviorembedding:
temporalinformationintoourmodel.(1)Order-leveltemporal
information:weuseintegerùëúùëüùëëùëíùëü ‚àà [0,ùëõ‚àí1] todenotesthe
order-levelinformationofthebehavior,ùëõisthelengthofbehaviors h=ùëÉùê∏+‚Ñé ùëê . (8)
sequenceùë†.(2)Moment-leveltemporalinformation:werepre-
sentthemomentashourofday‚Ñéùëúùë¢ùëüanddayofweekùëëùëéùë¶basedon 4.3.2 SequenceEncoder. Tolearnthesequenceembedding,we
employtransformerencoder[33]consistingofmulti-headattention
behavior‚Äôstimestamp.(3)Duration-leveltemporalinformation:
thedurationforbehaviorùëèiscalculatedas: layer,residualconnectionsandposition-wisefeed-forwardnetwork
(FNN).Givenaninputbehaviorrepresentationh,theself-attention
layercaneffectivelymineglobalsemanticinformationofbehavior
ùëëùë¢ùëüùëéùë°ùëñùëúùëõ ùëè =ùë°(ùëè)‚àíùë°(ùëè ùëõùëíùë•ùë°) (5) sequencecontextbylearningqueryQ,key Kandvalue Vmatrices
whereùëèandùëè ùëõùëíùë•ùë° arethebehaviorsonthesamedeviceandùëè ùëõùëíùë•ùë° ofdifferentvariables,whicharecalculatedas:
isthefirstbehaviorafterùëè thatoperatesonthedevice,andùë°(ùëè)
representstheoccurrencetimeofbehaviorùëè. Q=hW ùëÑ, K=hW ùêæ, V=hW ùëâ, (9)
