Make Your Home Safe: Time-aware Unsupervised User Behavior
Anomaly Detection in Smart Homes via Loss-guided Mask
JingyuXiaoâˆ— ZhiyaoXuâˆ— QingsongZouâˆ—
PengChengLaboratory Xiâ€™anUniversityofElectronicScience TsinghuaShenzhenInternational
TsinghuaShenzhenInternational andTechnology GraduateSchool
GraduateSchool Xiâ€™an,China PengChengLaboratory
Shenzhen,China 21009200843@stu.xidian.edu.cn Shenzhen,China
jy-xiao21@mails.tsinghua.edu.cn zouqs21@mails.tsinghua.edu.cn
QingLiâ€  DanZhao DongFang
PengChengLaboratory PengChengLaboratory Tencent
Shenzhen,China Shenzhen,China Shenzhen,China
liq@pcl.ac.cn zhaod01@pcl.ac.cn victordfang@tencent.com
RuoyuLi WenxinTang KangLi
TsinghuaShenzhenInternational TsinghuaShenzhenInternational TsinghuaShenzhenInternational
GraduateSchool GraduateSchool GraduateSchool
Shenzhen,China Shenzhen,China Shenzhen,China
liry19@mails.tsinghua.edu.cn vinsontang2126@gmail.com lk26603878@gmail.com
XudongZuo PenghuiHu YongJiang
TsinghuaShenzhenInternational TsinghuaUniversity TsinghuaShenzhenInternational
GraduateSchool Beijing,China GraduateSchool
Shenzhen,China huph22@mails.tsinghua.edu.cn PengChengLaboratory
zuoxd20@mails.tsinghua.edu.cn Shenzhen,China
jiangy@sz.tsinghua.edu.cn
ZixuanWeng MichaelR.Lyu
BeijingJiaotongUniversity TheChineseUniversityofHongKong
Beijing,China HongKong,China
20722027@bjtu.edu.cn lyu@cse.cuhk.edu.hk
ABSTRACT aLoss-guidedDynamicMaskStrategy(LDMS)toencouragethe
Smarthomes,poweredbytheInternetofThings,offergreatconve- modeltolearnlessfrequentbehaviors,whichareoftenoverlooked
niencebutalsoposesecurityconcernsduetoabnormalbehaviors, duringlearning.Second,weproposeaThree-levelTime-awarePo-
suchasimproperoperationsofusersandpotentialattacksfrom sitionEmbedding(TTPE)toincorporatetemporalinformationinto
maliciousattackers.Severalbehaviormodelingmethodshavebeen positionalembeddingtodetecttemporalcontextanomaly.Third,
proposedtoidentifyabnormalbehaviorsandmitigatepotential weproposeaNoise-awareWeightedReconstructionLoss(NWRL)
risks.However,theirperformanceoftenfallsshortbecausethey thatassignsdifferentweightsforroutinebehaviorsandnoisebehav-
donoteffectivelylearnlessfrequentbehaviors,considertemporal iorstomitigatetheinterferenceofnoisebehaviorsduringinference.
context,oraccountfortheimpactofnoiseinhumanbehaviors.In ComprehensiveexperimentsdemonstratethatSmartGuardconsis-
thispaper,weproposeSmartGuard,anautoencoder-basedunsuper- tentlyoutperformsstate-of-the-artbaselinesandalsooffershighly
viseduserbehavioranomalydetectionframework.First,wedesign interpretableresults.
âˆ—Thefirstthreeauthorshaveequalcontribution.
CCSCONCEPTS
â€ QingLiisthecorrespondingauthor.
â€¢Securityandprivacyâ†’Humanandsocietalaspectsofse-
ThisworkislicensedunderaCreativeCommonsAttribution curityandprivacy.
International4.0License.
KEYWORDS
KDDâ€™24,August25â€“29,2024,Barcelona,Spain
Â©2024Copyrightheldbytheowner/author(s).PublicationrightslicensedtoACM.
UserBehaviorModeling,AnomalyDetection,Transformer,Smart
ACMISBN979-8-4007-0490-1/24/08
https://doi.org/10.1145/3637528.3671708 Homes
4202
nuJ
81
]RC.sc[
2v82901.6042:viXra
KDDâ€™24,August25â€“29,2024,Barcelona,Spain JingyuXiao,ZhiyaoXuandQingsongZouetal.
ACMReferenceFormat:
JingyuXiao,ZhiyaoXu,QingsongZou,QingLi,DanZhao,DongFang,
RuoyuLi,WenxinTang,KangLi,XudongZuo,PenghuiHu,YongJiang,
ZixuanWeng,andMichaelR.Lyu.2024.MakeYourHomeSafe:Time-aware
UnsupervisedUserBehaviorAnomalyDetectioninSmartHomesviaLoss-
guidedMask.InProceedingsofthe30thACMSIGKDDConferenceonKnowl-
edgeDiscoveryandDataMining(KDDâ€™24),August25â€“29,2024,Barcelona,
Spain.ACM,NewYork,NY,USA,12pages.https://doi.org/10.1145/3637528.
3671708
1 INTRODUCTION
TherapidgrowthofIoTsolutionshasledtoanunprecedented
increaseinsmartdeviceswithinhomes,expectedtoreachapprox-
imately5billionby2025[24].However,theabnormalbehaviors
posesubstantialsecurityriskswithinsmarthomes.Theseabnor-
malbehaviorsusuallyoriginatefromtwoprimarysources.First,
improperoperationsbyuserscancauseabnormalbehaviors,such
asinadvertentlyactivatingtheairconditionerâ€™scoolingmodedur-
ingwinterorforgettingtocloseawatervalve.Second,malicious
attackerscanexploitvulnerabilitieswithinIoTdevicesandplat-
forms,takingunauthorizedcontrolofthesedevices.Forexample,
hackerscancompromiseIoTplatforms,allowingthemtodisable
securitycamerasandmanipulatehomeautomationsystems,creat-
ingopportunitiesforburglary.Thesesecurityconcernsemphasize
theurgencyofrobustbehavioralmodelingmethodsandenhanced
securitymeasurestosafeguardsmarthomeenvironments.
Deeplearninghasbeenemployedacrossvariousdomainsto
mine correlations between behaviors for modeling user behav-
iorsequences[22,31,32]andaddresssecurityissues[2,13â€“15].
DeepMove[9]leveragesRNNstomodelbothlongandshort-term
mobilitypatternsofusersforhumanmobilityprediction.Tocap-
ture the dynamics of userâ€™s behaviors, SASRec [20] proposes a
self-attentionbasedmodeltoachievesequentialrecommendation.
Morerecentefforts[4,8,30]primarilyfocusontransformer-based
modelsfortheirsuperiorabilitytohandlesequentialbehaviordata.
However,wecannotborrowtheabovemodelstodirectlyapply
theminourscenarios,becauseofthefollowingthreechallengesof
userbehaviormodelinginsmarthomes.
600
400
200
0
0 10 20 30 40 50 60 70
Behavior ID
roivaheB
fo
rebmuN
0.020
0.015
0.010
0.005
0.000
ssoL
noitcurtsnoceR
(e.g.,usingmicrowaveandoven)ofofficeworkersmaybeinfre-
quent,becausetheydineattheirworkplaceonweekdaysandonly
cookonweekends.Ontheotherhand,somedailybehaviorslike
turningonlightsandwatchingTVofthesameuserscanbemore
frequent.Behaviorimbalancecomplicatesthelearningprocessfor
models:somebehaviors,whichoccurfrequentlyinsimilarcontexts,
canbeeasilyinferred,whileothersthatrarelyappearormanifest
indiversecontextscanbemorechallengingtoinfer.Wetrainan
autoencodermodelonANdataset(showninTable1),recordtheoc-
currencesandreconstructionlossofdifferentbehaviors.Asshown
inFigure1,withthenumberofoccurrencesofbehaviordecreases,
thereconstructionlosstendstoincrease.
Second,temporalcontext,e.g.,thetiminganddurationofuser
behaviors,playsasignificantroleinabnormalbehaviordetection
butisoverlookedbyexistingsolutions.Forexample,turningon
thecoolingmodeoftheairconditionerinwinterisabnormal,but
isnormalinsummer.Showeringfor30-40minutesisnormal,but
exceeding2hoursuggestsauseraccident.Ignoringtiminginforma-
tionhinderstheidentificationofabnormalbehaviorpatterns.As
showninFigure2,sequence1representsauserâ€™snormallaundry-
related behaviors. Sequences 2 and 3 follow the same order as
sequence1.However,insequence2,thewatervalvewereopensat
2oâ€™clockinthenight.Insequence3,thedurationbetweenopening
2 Problem Definition
andclosingthewatervalveisexcessivelylong.Thereforethese
twosequencesshouldbeidentifiedasabnormalbehaviorspossibly
conductedbyattackersintendingtoinducewaterleakage.
open open notification close
9am 9:10am 9:50am 10am
open open notification close
2am 2:10am 2:50am 3am
open open notification close
9am 9:10am 9:50am â€¦â€¦ 12am
Figure 2: Example of three user behaviors with the same
behaviororder.Sequence2and3areabnormalduetotheir
inappropriatetimingandexcessiveduration.
Third,arbitraryintentsandpassivedeviceactionscancause
noisebehaviorsinuserbehaviorsequences,whichinterferemodelâ€™s
inference.Figure3showsnoisebehaviorsinabehaviorsequence
relatedtoauserâ€™sbehaviorsaftergettingup.Theuserdosome
Figure1:Reconstructionlossesforbehaviorswithdifferent
routinebehaviorslikeâ€œturnonthebedlightâ€,â€œopenthecurtainsâ€,
occurrencefrequencies.
â€œswitchofftheairconditionerâ€,â€œopentherefrigeratorâ€,â€œclosethe
refrigeratorâ€andâ€œswitchontheovenâ€.However,therearealso
First,theoccurrencefrequenciesofdifferentuserbehaviorsmay somesporadicactionswhicharenottightlyrelatedtothebehavior
beimbalanced,leadingtochallengesinlearningthesemanticsof sequence,including1)activebehaviors,e.g.,suddenlydecidingto
thesebehaviors.Thisuserbehaviorimbalancecanbeattributed â€œturnonthenetworkaudioâ€tolistentomusic;2)passivebehavior
toindividualsâ€™livinghabits.Forexample,cook-relatedbehaviors fromdevices,e.g.,theâ€œself-refreshâ€oftheairpurifier.Thesenoise
MakeYourHomeSafe:Time-awareUnsupervisedUserBehaviorAnomalyDetectioninSmartHomesviaLoss-guidedMask KDDâ€™24,August25â€“29,2024,Barcelona,Spain
behaviorsmayalsooccurinothersequenceswithvaryingpatterns. andmulti-levelperiodicities.However,abovemethodsaimatpre-
Thesenoisebehaviorsintroducesuncertaintythatcandisruptthe dictingnextbehaviorofuseraccurately,theycannotbeapplied
learningprocessandleadthemodeltomisclassifysequencescon- intoabnormalbehaviordetection.
taining noise behaviors as anomalies. Therefore, treating noise
behaviorsonparwithnormalbehaviorscouldpotentiallyharmthe 2.2 AttacksandDefensesinSmartHomes
modelâ€™sperformance,leadingtoincreasedlosses. Anincreasingnumberofattackvectorshavebeenidentifiedin
smarthomesinrecentyears.Inadditiontocyberattacks,itisalsoa
on open off open close open switch onself-refresh concerningfactorthatIoTdevicesareoftencloseassociationwith
theuserâ€™sphysicalenvironmentandtheyhavetheabilitytoalter
ğ‘¡( ğ‘¡â€™ ğ‘¡" ğ‘¡! ğ‘¡# ğ‘¡$ ğ‘¡% ğ‘¡& physicalenvironment.Inthiscontext,theautomationintroduces
moreserioussecurityrisks.Priorresearchhasrevealedthatad-
routine behaviors noise behaviors
versariescanleakpersonalinformation,andgainphysicalaccess
tothehome[3,19].In[10],spoofattackisemployedtoexploit
l b ig e h d t curtain cond a it ir io ner refrigerator oven ne au tw d o io rk pu a ri i f r i er automationrulesandtriggerunexpecteddeviceactions.[7,11]
applydelay-basedattackstodisruptcross-platformIoTinforma-
tionexchanges,resultinginunexpectedinteractions,renderingIoT
Figure3:Anexampleofnoisebehaviors.
devicesandsmarthomesinaninsecurestate.Thisseriesofattacks
aim at causing smart home devices to exhibit expected actions,
Inthispaper,weproposeSmartGuardtosolveabovechallenges.
therebyposingsignificantsecuritythreats.Therefore,designingan
SmartGuardisanautoencoder-basedarchitecture,whichlearnsto
effectivemechanismtodetectsuchattacksisnecessary.6thSense
reconstructnormalbehaviorsequencesduringtrainingandidentify
[27]utilizesNaiveBayestodetectmaliciousbehaviorassociated
thebehaviorsequenceswithhighreconstructionlossasanomaly.
withsensorsinsmarthomes.Aegis[28]utilizesaMarkovChainto
Firstly,wedeviseaLoss-guidedDynamicMaskStrategy(LDMS)
detectmaliciousbehaviors.ARGUS[26]designedanAutoencoder
topromotethemodelâ€™slearningofinfrequenthard-to-learnbehav-
basedonGatedRecurrentUnits(GRU)todetectinfiltrationattacks.
iors.Secondly,weintroduceaThree-levelTime-awarePosition
However,thesemethodsignorethebehaviorimbalance,temporal
Embedding(TTPE)tointegratetemporalinformationintoposi-
informationandnoisebehaviors.
tionalembeddingfordetectingtemporalcontextanomalies.Lastly,
weproposeaNoise-awareWeightedReconstructionLoss(NWRL)
3 PROBLEMFORMULATION
toassigndistinctweightstoroutinebehaviorsandnoisebehaviors,
LetDdenoteasetofdevices,Cdenoteasetofdevicecontrolsand
therebymitigatingtheimpactofnoisebehaviors.Ourcodesare
releasedtotheGitHub1.Ourcontributionscanbesummarizedas Sdenoteasetofbehaviorsequences.
follows: Definition1. (Behavior)Abehaviorğ‘ = (ğ‘¡,ğ‘‘,ğ‘),isa3-tuple
â€¢ WedesignLDMStomaskthebehaviorswithhighrecon- consistingoftimestampğ‘¡,deviceğ‘‘ âˆˆDanddevicecontrolğ‘ âˆˆC.
structionloss,thusencouragingthemodeltolearnthese
Forexample,behaviorb=(2022-08-0418:30,airconditioner,air
hard-to-learnbehaviors.
conditioner:switchon)describesthebehaviorâ€œswichontheaircon-
â€¢ WeproposeTTPEtoconsidertheorder-level,moment-level
ditionerâ€at18:30on2022-08-04.
andduration-levelinformationofuserbehaviorsmeanwhile.
â€¢ WedesignNWRLtotreatnoisybehaviorsandnormalbehav- Definition2. (BehaviorSequence)Abehaviorsequenceğ‘  =
iorsdifferentlyforlearningrobustbehaviorrepresentations. [ğ‘
1
,ğ‘
2
,Â·Â·Â·,ğ‘ ğ‘›] âˆˆSisalistofbehaviors,orderedbytheirtimestamps,
andğ‘›isthelengthofğ‘ .
2 RELATEDWORK
WedefinetheUserBehaviorSequence(UBS)anomalydetection
2.1 UserBehaviorModelinginSmartHomes
problemasfollows.
Someworksproposetomodeluserbehavior(i.e.,userdevicein-
Problem 1. (UBS Anomaly Detection) Given a behavior se-
teraction)basedondeeplearning.[16]useseventtransitiongraph
quenceğ‘ ,determinewhetherğ‘ isananomalyeventoranormalevent.
tomodelIoTcontextanddetectanomalies.In[34],authorsbuild
deviceinteractiongraphtolearnthedevicestatetransitionrela- Inthispaper,weconsiderfourtypesofabnormalbehaviors:
tionshipcausedbyuseractions.[12]detectsanomaliesthroughcor-
â€¢ (SD)SingleDevicecontextanomaly(Figure4(a)),definedas
relationalanalysisofdeviceactionsandphysicalenvironment.[29]
unusualhighfrequencyoperationsonasingledevice,e.g.,
infersuserbehaviorthroughreadingsfromvarioussensorsinstalled
frequentlyswitchinglightonandofftobreakthelight.
intheuserâ€™shome.IoTBeholder[38]utilizesattention-basedLSTM
â€¢ (MD)MultipleDevicescontextanomaly(Figure4(b)),de-
topredicttheuserbehaviorfromhistorysequences.SmartSense
finedasthesimultaneousoccurrenceofbehaviorsonmul-
[18]leveragesquery-basedtransformertomodelcontextualinfor-
tiple devices that are not supposed to occur in the same
mationofuserbehaviorsequences.DeepUDI[35]andSmartUDI
sequence,e.g.,turningoffthecameraandopeningthewin-
[36]userelationalgatedgraphneuralnetworks,capsuleneural
dowforburglary.
networksandcontrastivelearningtomodelusersâ€™routines,intents
â€¢ (DM)Devicecontrol-Momentcontextanomaly(Figure4(c)),
1https://github.com/xjywhu/SmartGuard definedasadevicecontroloccurringataninappropriate
Challenge
1
KDDâ€™24,August25â€“29,2024,Barcelona,Spain JingyuXiao,ZhiyaoXuandQingsongZouetal.
2)randommask:maskingbehaviorsateveryepochrandomlyto
reconstruct the masked behaviors; 3) top-ğ‘˜ loss mask: masking
topğ‘˜b(ea)h Aatvteinotriosn wWietighhhtigherreconstructionlosstoreconstructthe
on off broken close open theft masked behaviors. We set mask ratio as 20% for the latter two.
(a) Single Device Context Anomaly. (b) Multiple Devices Context Anomaly. Figure6showsthechangingtrendsofthereconstructionlossand
itâ€™svarianceofdifferentbehaviorduringtrainingonSPdataset
(describedinTable1).First,asshowninFigure6(a),themodel
withoutmaskshowsthefastestconvergencetrend,whereasthe
cooling winter cold open three hours flood lossofthemodelwithmaskfluctuates.Modelwithoutmaskcan
(c) Device Control-Moment Context Anomaly. (d) Device Control-Duration Context Anomaly. simultaneouslylearnallbehaviors,facilitatingrapidconvergence.
Incontrast,themaskstrategyonlyencouragesthemodeltofocus
Figure4:Differenttypesofanomalybehaviors. onlearningmaskedbehaviors,whichmayhinderinitial-stagecon-
vergence.Second,themodelwithtop-ğ‘˜lossmaskstrategyshows
lowestvariancetowardstheendoftrainingasshowninFigure6(b),
time,e.g.,turningonthecoolingmodeofanairconditioner becausethetop-ğ‘˜ lossmaskstrategyeffectivelyencouragesthe
inwinter,potentiallycausingtheusertocatchacold. modeltolearnhard-to-learnbehaviors(i.e.,thebehaviorswithhigh
â€¢ (DD)Devicecontrol-Durationcontextanomaly(Figure4(d)), reconstruction loss), thereby reducing the variance of behavior
definedasdevicecontrolsthatlastforaninappropriatedu- reconstructionlosses.
ration,e.g.,leavingawatervalveopenfor3hoursforflood Inthispaper,wedesignaLoss-guidedDynamicMaskStrategy.
attack. Intuitively,atthebeginningoftraining,weencouragethemodel
tolearntherelativelyeasytasktoaccelerateconvergence,i.e.,
4 METHODOLOGY behaviorsequencereconstructionwithoutmask.Aftertrainingğ‘
epochswithoutmask,weadoptthetop-ğ‘˜ lossmaskstrategyto
4.1 SolutionOverview
encouragethemodeltolearnthemaskedbehaviorswith
Toachieveaccurateuserbehaviorsequenceanomalydetectionin
high reconstruction loss. We continuously track the modelâ€™s
smarthomes,weproposeSmartGuard,depictedinFigure5.The
reconstructionlossofdifferentbehaviorsbyupdatingalossvector
workflowofSmartGuardcanbesummarizedasfollows.During
ineachepochtoguidethemaskstrategyinthenextepoch.In
training,theLoss-guidedDynamicMaskStrategy(Â§4.2)isinitially epochğ‘’ğ‘,thelossvectorL ğ‘’ğ‘ iscalculatedas:
vec
employedtomaskhard-to-learnbehaviorsbasedonthelossvec-
torL vecfromthepreviousepoch.Subsequently,theThree-level L v ğ‘’ e ğ‘ c = (cid:8)â„“ 1 ,â„“ 2 ,...,â„“ ğ‘ ,...,â„“ |C| (cid:9),ğ‘ âˆˆC, (1)
T
le
i
v
m
e
e
l,
-a
m
w
o
a
m
re
en
P
t
o
-
s
l
i
e
t
v
io
e
n
l,
a
a
l
n
E
d
nc
d
o
u
d
r
e
a
r
ti
(
o
Â§
n
4
-
.3
le
.1
v
)
e
i
l
s
t
a
e
p
m
p
p
li
o
e
r
d
a
t
l
o
in
c
f
a
o
p
r
t
m
ur
a
e
ti
o
o
r
n
de
o
r
f
-
â„“ ğ‘ = ğ‘› 1 âˆ‘ï¸
ğ‘›ğ‘
â„“ ğ‘ ğ‘–, (2)
thebehaviors,producingthepositionalembeddingğ‘ƒğ¸.Thisembed- ğ‘ ğ‘–=1
dingisthenaddedtothedevicecontrolembeddingâ„ ğ‘ toformthe whereğ‘› ğ‘isthenumberoftimesthedevicecontrolğ‘occursinepoch
behaviorembeddingh.Finally,hisfedintoanğ¿-layerattention- ğ‘’ğ‘,andâ„“ ğ‘ istheaveragereconstructionlossofthedevicecontrol
basedencoderanddecodertoextractcontextualinformationfor
ğ‘.Inepochğ‘’ğ‘+1,themaskvectorforbehaviorsequencesample
reconstructingthesourcesequence.Duringtheinferencephase,the ğ‘  = [ğ‘ 1 ,ğ‘ 2 ,Â·Â·Â·,ğ‘ ğ‘›]isobtainedas:
N Re o c is o e n - s a t w ru a c r t e io W n e L ig o h ss te ( d Â§4 R .4 e ) co is n u st t r i u li c z t e i d on to L a o s s s s ig N n o d is i e ff - e a r w en ar t e w W ei e g i h gh ts te to d ğ‘šğ‘ğ‘ ğ‘˜(ğ‘–)= (cid:110) 1 0 , , i i f f ğ‘– ğ‘– âˆ‰ âˆˆ ğ‘  ğ‘  ğ‘œ ğ‘œ ğ‘Ÿ ğ‘Ÿ ğ‘¡ ğ‘¡ ğ‘’ ğ‘’ ğ‘‘ ğ‘‘ _ _ ğ‘– ğ‘– ğ‘› ğ‘› ğ‘‘ ğ‘‘ ğ‘’ ğ‘’ ğ‘¥ ğ‘¥ [ [ : : âŒŠ âŒŠ ğ‘› ğ‘› Â· Â· ğ‘Ÿ ğ‘Ÿ âŒ‹ âŒ‹ ] ] ,ğ‘– âˆˆ [1,ğ‘›], (3)
variousbehaviors,determinedbythelossvectorfromthetraining (cid:16)(cid:110) ğ‘’ğ‘ ğ‘’ğ‘ ğ‘’ğ‘ (cid:111)(cid:17)
dataset,resultinginthefinalreconstructionlossğ‘ ğ‘ğ‘œğ‘Ÿğ‘’.Iftheğ‘ ğ‘ğ‘œğ‘Ÿğ‘’ ğ‘ ğ‘œğ‘Ÿğ‘¡ğ‘’ğ‘‘_ğ‘–ğ‘›ğ‘‘ğ‘’ğ‘¥ =argsort L vec (ğ‘ 1 ),L vec (ğ‘ 2 ),....L vec (ğ‘ ğ‘›) , (4)
surpassesthethresholdğ‘¡â„,SmartGuardtriggersanalarm. whereargsortgetsthesortedindexwithdescendingorderofthe
elementsinthevector,ğ‘Ÿ âˆˆ [0,1] isthemaskratio,andğ‘› isthe
4.2 Loss-guidedDynamicMaskStrategy lengthofbehaviorsequenceğ‘ .
Autoencoders[37],whichtakecompletedatainstancesasinput
4.3 AutoencoderwithTemporalInformation
andtargettoreconstructtheentireinputdata,arewidelyusedin
anomalydetection.Differentfromtraditionalautoencoders,masked 4.3.1 Three-levelTime-awarePositionalEncoder. Thetem-
autoencodersrandomlymaskaportionofinputdata,encodingthe poralinformationinuserbehaviorsequencedataprimarilyresides
partially-maskeddataandaimingtoreconstructthemaskedtokens. inthetimingofcontrolbehaviors,whichcanbeexaminedfrom
Byintroducingamoremeaningfulself-supervisedtask,maskedau- twoperspectives:theabsolutetimingofeachindividualcontrol
toencodershaverecentlyexcelledinimages[17]learning.However, behavior,andtherelativetiminggapbetweencontrolactionson
suchreconstructiontaskswithoutmaskandwithrandommaskare thesamedevice.Ontheonehand,therelativetiminggapbetween
sub-optimalinourscenariosbecausetheydonotemphasizethe controlactionsonthesamedevicereflectsthedurationthedevice
learningofhard-to-learnbehaviorsthatoccurrarely. isinsomespecificstateandtheoperationfrequencyoftheuser.
Weconductexperimentstoverifytheperformanceofautoen- Ontheonehand,userbehaviorsareusuallytime-regulated,and
coders trained with three mask options: 1) w/o mask: no mask thefunctionalitiesadevicecarriedcandeterminetheabsolutetim-
strategyisused,theobjectivefunctionistoreconstructtheinput; ingusersoperateonit.Forexample,usersusuallyoperatelights
MakeYourHomeSafe:Time-awareUnsupervisedUserBehaviorAnomalyDetectioninSmartHomesviaLoss-guidedMask KDDâ€™24,August25â€“29,2024,Barcelona,Spain
0 1 2 3 4 5 6 7 order
Behavior Weight ğ‘¾ğ’“ğ’†ğ’„ Noise-aware
â€¦â€¦ Weighted
ğ‘¡ ( ğ‘¡ â€™ ğ‘¡ " duration ğ‘¡ ! ğ‘¡ # dur ğ‘¡ a $ tion ğ‘¡ % ğ‘¡ & moment Reconstruction
Noise Behaviors Loss
Loss-guided Dynamic Masked Strategy Loss Loss Vector â„’ğ’—ğ’†ğ’„ Yes No
<ğ’•ğ’‰?
hard-to-learn
easy-to-learn
Mask Mask Mask
Behavior Encoder & Decoder
Update
Three-level Time-aware Positional Device Control Architecture
Encoder Encoder Reconstruction Loss â„’ğ’“ğ’†ğ’„
Order Hour Day Duration DeviceControl â€¦â€¦ Multi-head
Embedding Embedding Embedding Embedding Embedding
ğ‘·ğ‘¬(ğ‘¶ğ’“ğ’…ğ’†ğ’“) ğ‘·ğ‘¬(ğ‘¯ğ’ğ’–ğ’“) ğ‘·ğ‘¬(ğ‘«ğ’‚ğ’š) ğ‘·ğ‘¬(ğ‘«ğ’–ğ’“ğ’‚ğ’•ğ’Šğ’ğ’) ğ’‰ğ’„ Attention
ğ¿Ã— Add & Norm
Prediction Layer
Feed Forward
Behavior
Embedding h
Add & Norm
Sequence Encoder Sequence Decoder
Figure5:Theoverviewof SmartGuard.
1.2 1.0 0.8 0.6
0.4
0.2 0.0
123456789101112131415 Training Step
ssoL noitcurtsnoceR
fo naeM
w/o Mask 10 Random Mask Top-k Loss Mask 8 6
4
2 0
123456789101112131415 Training Step
(a)Meanofreconstructionloss.
ssoL
noitcurtsnoceR
fo
ecnairaV
Then,thepositionalembeddingiscalculatedas:
1.50 1.25 1.00 0 0 . . 5 7 0 5 ğ‘ƒğ¸=ğ‘¤ ğ‘œğ‘Ÿğ‘‘ğ‘’ğ‘Ÿ Â·ğ‘ƒğ¸(ğ‘ğ‘œğ‘ )+ğ‘¤ â„ğ‘œğ‘¢ğ‘Ÿ Â·ğ‘ƒğ¸(â„ğ‘œğ‘¢ğ‘Ÿ)+ 0 0 . . 0 2 0 5 9 101112131415 ğ‘¤ ğ‘‘ğ‘ğ‘¦Â·ğ‘ƒğ¸(ğ‘‘ğ‘ğ‘¦)+ğ‘¤
ğ‘‘ğ‘¢ğ‘Ÿ
Â·ğ‘ƒğ¸(ğ‘‘ğ‘¢ğ‘Ÿğ‘ğ‘¡ğ‘–ğ‘œğ‘›), (6)
w/o Mask R To a p n - d k o L m os M s a M s a k sk whereğ‘¤ ğ‘œğ‘Ÿğ‘‘ğ‘’ğ‘Ÿ,ğ‘¤ â„ğ‘œğ‘¢ğ‘Ÿ,ğ‘¤ ğ‘‘ğ‘ğ‘¦ andğ‘¤ ğ‘‘ğ‘¢ğ‘Ÿ arelearnableweights.ğ‘ƒğ¸(Â·)
isapositionalencodingfunction[33]definedas:
(b)Varianceofreconstructionloss.
ğ‘ƒğ¸ (Â·,2ğ‘–) =sin
(cid:16) Â·/100002ğ‘–/ğ‘‘(cid:17)
,
(7)
F
d
i
i
g
ff
u
e
r
r
e
en
6
t
:A
m
u
a
t
s
o
k
en
st
c
r
o
a
d
te
e
g
r
i
t
e
r
s
a
.
iningprocessonSPdatasetunder
ğ‘ƒğ¸ (Â·,2ğ‘–+1) =cos
(cid:16) Â·/100002ğ‘–/ğ‘‘(cid:17)
,
whereğ‘–denotestheğ‘–-thdimensionofthepositionalembedding,ğ‘‘
isthedimensionoftemporalembedding.
inthemorningandevening,andoperatethemicrowaveandthe
ovenatmealtime.Sincecertainoperationsfrequentlytakeplace Tolearntherepresentationâ„ ğ‘ fordevicecontrolğ‘ âˆˆC,wefirst
encodedevicecontrolğ‘intoalow-dimensionallatentspacethrough
nearlysimultaneously,wewillalsoconsidertheorderofbehaviors
devicecontrolencoder,i.e.,anembeddinglayer.Finally,weadd
toprovideamorecomprehensivecharacterizationofbehaviors
positionalembeddingtothedevicecontrolembeddingasfollowing
thatoccursuccessively.Therefore,weincorporatethreetypesof
togetthebehaviorembedding:
temporalinformationintoourmodel.(1)Order-leveltemporal
information:weuseintegerğ‘œğ‘Ÿğ‘‘ğ‘’ğ‘Ÿ âˆˆ [0,ğ‘›âˆ’1] todenotesthe
order-levelinformationofthebehavior,ğ‘›isthelengthofbehaviors h=ğ‘ƒğ¸+â„ ğ‘ . (8)
sequenceğ‘ .(2)Moment-leveltemporalinformation:werepre-
sentthemomentashourofdayâ„ğ‘œğ‘¢ğ‘Ÿanddayofweekğ‘‘ğ‘ğ‘¦basedon 4.3.2 SequenceEncoder. Tolearnthesequenceembedding,we
employtransformerencoder[33]consistingofmulti-headattention
behaviorâ€™stimestamp.(3)Duration-leveltemporalinformation:
thedurationforbehaviorğ‘iscalculatedas: layer,residualconnectionsandposition-wisefeed-forwardnetwork
(FNN).Givenaninputbehaviorrepresentationh,theself-attention
layercaneffectivelymineglobalsemanticinformationofbehavior
ğ‘‘ğ‘¢ğ‘Ÿğ‘ğ‘¡ğ‘–ğ‘œğ‘› ğ‘ =ğ‘¡(ğ‘)âˆ’ğ‘¡(ğ‘ ğ‘›ğ‘’ğ‘¥ğ‘¡) (5) sequencecontextbylearningqueryQ,key Kandvalue Vmatrices
whereğ‘andğ‘ ğ‘›ğ‘’ğ‘¥ğ‘¡ arethebehaviorsonthesamedeviceandğ‘ ğ‘›ğ‘’ğ‘¥ğ‘¡ ofdifferentvariables,whicharecalculatedas:
isthefirstbehaviorafterğ‘ thatoperatesonthedevice,andğ‘¡(ğ‘)
representstheoccurrencetimeofbehaviorğ‘. Q=hW ğ‘„, K=hW ğ¾, V=hW ğ‘‰, (9)
